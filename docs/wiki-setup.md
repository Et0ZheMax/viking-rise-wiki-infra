# Базовая настройка Wiki.js для Viking Rise

Этот документ описывает минимальные шаги после первого запуска Wiki.js, чтобы получить работоспособный сайт с базовыми настройками темы, логотипа и поиска. Все действия выполняются через веб-интерфейс Wiki.js после того, как инфраструктура из `docker-compose.yml` поднята и доступна по `http://localhost:<PUBLIC_HTTP_PORT>`.

## 1. Первая авторизация и создание администратора
1. Перейдите в браузере на `http://localhost:<PUBLIC_HTTP_PORT>`.
2. На экране первичной настройки введите данные admin-аккаунта:
   - **Email** — рабочий адрес для уведомлений (можно временный, например `admin@example.com`).
   - **Password** — придумайте сложный пароль, не используйте значения из `.env`.
3. Подтвердите создание учётной записи и выполните вход под администратором.

> Рекомендация: сразу добавьте резервный администраторский аккаунт через **Administration → Users**, чтобы не потерять доступ.

## 2. Основные параметры сайта
Откройте **Administration → General → Site** и задайте базовые значения:
- **Site Title**: `Viking Rise Wiki` или любое другое название проекта.
- **Hostname**: домен или `localhost:<PUBLIC_HTTP_PORT>` на время разработки.
- **Language**: `Русский` (или нужный язык интерфейса). Если требуется несколько языков, добавьте их в **Administration → Localization**.
- **Time Zone**: выберите локальный часовой пояс (например, `Europe/Moscow`), чтобы корректно работали логи и расписания задач.

При необходимости включите брендирование email-уведомлений: **Administration → Mail Templates**.

## 3. Настройка темы и брендинга
Раздел **Administration → Theme** позволяет быстро привести интерфейс к стилистике Viking Rise:
1. **Основные цвета**: задайте акцентный цвет в тоне золота/янтаря (например, `#D69E2E`), фон — тёмный серо-синий (например, `#1E293B`). Эти значения можно будет уточнить позже в `docs/design-notes.md`.
2. **Логотип**: загрузите файл PNG/SVG через **Administration → Theme → Logo**. Для тёмной темы подготовьте версию с прозрачным фоном.
3. **Favicon**: загрузите иконку 32×32 или 64×64 (формат `.ico` или `.png`) через тот же раздел.
4. **Custom CSS**: если нужно тонко настроить элементы, вставьте стили из будущего файла `assets/custom-theme.css` в поле **Custom Stylesheet**. Изменения применяются мгновенно — обновите страницу для проверки.

## 4. Настройки редактора и загрузок
Перейдите в **Administration → Editing**:
- **Default Editor**: оставьте `Visual Editor`, чтобы авторам без технических навыков было проще работать.
- **Uploads → Storage**: по умолчанию используется локальное хранилище (`/data/wiki/uploads`). Этого достаточно для стенда; для продакшена можно подключить S3-совместимое хранилище.
- **Uploads → Limits**: задайте ограничения по размеру файлов (например, 25–50 МБ) и допустимые типы (`.png`, `.jpg`, `.webp`, `.mp4`).

## 5. Поиск и индексация
Включите корректную индексацию контента:
1. Откройте **Administration → Search → Engines** и убедитесь, что включён встроенный **Database** движок.
2. Нажмите **Rebuild Index**, чтобы пересобрать поиск после загрузки тестовых страниц.
3. Для продакшена можно добавить внешний движок (например, Elasticsearch или MeiliSearch). Если будете подключать внешний сервис, задокументируйте его переменные окружения в `.env.example`.

## 6. Безопасность и доступы
- Включите **Two-Factor Authentication** для администраторов (раздел **Administration → Authentication → 2FA**).
- Ограничьте открытую регистрацию: в **Administration → Authentication → Local** отключите свободный self-signup и создавайте учётные записи вручную или через SSO.
- Создайте роли и права заранее (будет детализировано в `docs/roles-and-permissions.md`). Для начала достаточно ролей `Admin`, `Editor`, `Author`, `Reader`.

## 7. Резервное копирование и обслуживание
- После начальной настройки запустите бэкап БД: `python scripts/backup_db.py` (Linux/WSL с `sudo`) или `py scripts\backup_db.py` (Windows, администратор). Дамп попадёт в `backups/`.
- Периодически проверяйте инфраструктуру скриптом `scripts/health_check.py`, особенно после обновлений Docker-образов или правок конфигов.

## 8. Что дальше
- Для структуры разделов и шаблонов статей см. будущие файлы `docs/content-structure.md` и `docs/article-template.md` из roadmap.
- Для детальной цветовой схемы и CSS — `docs/design-notes.md` и `assets/custom-theme.css` (будут добавлены на следующих фазах).
- Если планируется публичный домен и HTTPS, подготовьте внешний reverse-proxy или отдельный Nginx-конфиг с TLS и перенаправлением на `wiki:3000`.
